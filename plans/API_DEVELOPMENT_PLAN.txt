API Development Plan (Implemented)
=================================

Date: 2026-02-16
Stack: Django REST Framework (DRF)
Versioning: /api/v1/

1) Foundation
- Added versioned API namespace under api/v1.
- Added reusable tenant and accounting permission classes.
- Added DRF global settings in core/settings.py:
  - Session + Basic authentication
  - IsAuthenticated default permission
  - pagination + search + ordering support

2) Tenant & Auth Context APIs
- GET  /api/v1/auth/context/
- GET  /api/v1/auth/companies/
- POST /api/v1/auth/switch-company/

3) HR/Payroll Domain APIs
- Departments:       /api/v1/departments/
- Employees:         /api/v1/employees/
- Employee self:     /api/v1/employees/me/
- Payroll configs:   /api/v1/payrolls/
- Payroll entries:   /api/v1/payroll-entries/
- Payroll runs:      /api/v1/payroll-runs/
- Close run action:  /api/v1/payroll-runs/{id}/close/
- Run entries:       /api/v1/payroll-run-entries/
- Leave policies:    /api/v1/leave-policies/
- Leave requests:    /api/v1/leave-requests/
- Leave actions:
  - /api/v1/leave-requests/{id}/approve/
  - /api/v1/leave-requests/{id}/reject/
- IOUs:              /api/v1/ious/
- IOU actions:
  - /api/v1/ious/{id}/approve/
  - /api/v1/ious/{id}/reject/
  - /api/v1/ious/{id}/mark_paid/

4) Accounting APIs
- Accounts:          /api/v1/accounts/
- Fiscal years:      /api/v1/fiscal-years/
- Accounting periods:/api/v1/accounting-periods/
- Journals:          /api/v1/journals/
- Journal entries:   /api/v1/journal-entries/
- Journal actions:
  - /api/v1/journals/{id}/submit/
  - /api/v1/journals/{id}/approve/
  - /api/v1/journals/{id}/post/
  - /api/v1/journals/{id}/reverse/
- Period/FY close actions:
  - /api/v1/accounting-periods/{id}/close/
  - /api/v1/fiscal-years/{id}/close/

5) Security/Access Model
- Tenant resources are scoped by active company.
- Accounting resources use role-based access checks.
- Custom workflow actions use model methods (approval/post/reverse/close).

6) Tests Added
- Tenant scope on employee listing.
- Department create auto-assigns active company.
- Switch-company endpoint updates active company.

7) Completed Additions
- JWT token endpoints:
  - POST /api/v1/auth/token/
  - POST /api/v1/auth/token/refresh/
- OpenAPI docs:
  - GET /api/v1/schema/
  - GET /api/v1/docs/swagger/
  - GET /api/v1/docs/redoc/
- Expanded API tests for:
  - auth-required endpoint behavior
  - cross-tenant action access denial
  - model-permission denial on actions
